<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    Viết hàm nhóm đặc điểm của người dùng Viết hàm groupBy(arr, key) nhận vào
    một danh sách người dùng và một key, trả về object nhóm người dùng theo đặc
    điểm key.
  </body>
  <script>
    // Input:
    const users = [
      { fullname: "Nguyen Van A", age: 20, address: "LangSon" },
      { fullname: "Nguyen Van B", age: 22, address: "BacGiang" },
      { fullname: "Nguyen Van C", age: 21, address: "HaNoi" },
      { fullname: "Nguyen Van D", age: 22, address: "HaNoi" },
      { fullname: "Nguyen Van E", age: 32, address: "LangSon" },
    ];

    // khởi tạo một biến groupBy với giá trị là một hàm (function expression).
    function groupBy(arr, key) {
      // Hàm groupBy dùng để nhóm các phần tử trong mảng 'arr' theo thuộc tính 'key'

      return arr.reduce((acc, cur) => {
        // Duyệt qua từng phần tử trong mảng 'arr' bằng reduce
        // 'acc' là đối tượng chứa kết quả nhóm
        // 'cur' là phần tử hiện tại trong quá trình duyệt

        const groupAge = cur[key];
        // Lấy giá trị của key cần nhóm từ phần tử hiện tại
        // Ví dụ: nếu key là 'age', thì groupAge có thể là 18, 20, v.v.

        if (!acc[groupAge]) {
          acc[groupAge] = [];
          // Nếu chưa có nhóm nào mang giá trị 'groupAge', tạo mảng mới cho nhóm đó
        }

        acc[groupAge].push(cur);
        // Thêm phần tử hiện tại vào đúng nhóm tương ứng

        return acc;
        // Trả về đối tượng nhóm để dùng trong lần lặp tiếp theo
      }, {}); // Giá trị khởi tạo là object rỗng, vì ta đang gom nhóm theo key
    }

    // Output:
    const result1 = groupBy(users, "age"); // nhóm theo tuổi

    console.log(result1);

    // {
    // 	20: [
    // 		{ fullname: "Nguyen Van A", age: 20, address: "LangSon" }
    // 	],
    // 	21: [
    // 		{ fullname: "Nguyen Van C", age: 21, address: "HaNoi" }
    // 	],
    // 	22: [
    // 		{ fullname: "Nguyen Van B", age: 22, address: "BacGiang" },
    // 		{ fullname: "Nguyen Van D", age: 22, address: "HaNoi" }
    // 	],
    // 	32: [
    // 		{ fullname: "Nguyen Van E", age: 32, address: "LangSon" }
    // 	]
    // }

    const result2 = groupBy(users, "address"); // nhóm theo địa chỉ

    console.log(result2);

    // {
    // 	"LangSon": [
    // 		{ fullname: "Nguyen Van A", age: 20, address: "LangSon" },
    // 		{ fullname: "Nguyen Van E", age: 32, address: "LangSon" }
    // 	],
    // 	"BacGiang": [
    // 		{ fullname: "Nguyen Van B", age: 22, address: "BacGiang" }
    // 	],
    // 	"HaNoi": [
    // 		{ fullname: "Nguyen Van C", age: 21, address: "HaNoi" },
    // 		{ fullname: "Nguyen Van D", age: 22, address: "HaNoi" }
    // 	]
    // }
  </script>
</html>
